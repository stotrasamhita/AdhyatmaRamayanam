% !TeX program = XeLaTeX
% !TeX root = gitabook.tex
\usepackage{shloka}
\usepackage{wallpaper}
\newcounter{totalshlokas}
\newcounter{kandashlokas}
\newcounter{sargacount}
\setmainfont[Script=Devanagari]{Sanskrit 2003}
\newfontscript{Devanagari}{deva,dev2}

%%% HEADERS and FOOTERS %%%
\usepackage{fancyhdr}
\pagestyle{fancyplain}
\setlength{\headheight}{28pt}
\lhead[\fancyplain{\rightmark}{\pagenumfont\large\thepage}]
   {\fancyplain{\rightmark}{\leftmark}}
\rhead[\fancyplain{\rightmark}{\leftmark}]
   {\fancyplain{\rightmark}{\pagenumfont\large\thepage}}
\cfoot{}

\fancypagestyle{fancyplain}{ %
\fancyhf{} % remove everything
\renewcommand{\headrulewidth}{0pt} % remove lines as well
\renewcommand{\footrulewidth}{0pt}
\cfoot{\pagenumfont\large\thepage}}

%%% SECTIONS and CHAPTERS %%%
\makeatletter
\renewcommand\section{\refstepcounter{sargacount}\resetShloka\@startsection {section}{1}{\z@}%
%{2.3ex \@plus.2ex}%
%{-3.5ex \@plus -1ex \@minus -.2ex}%
%{2.3ex \@plus.2ex}%
{10pt}
{2pt}
{\normalfont\LARGE\bfseries}}

\renewcommand\chapter{\setcounter{sargacount}{0}\setcounter{kandashlokas}{0}\resetShloka\@startsection {chapter}{1}{\z@}%
{10pt}
{2pt}
{\normalfont\LARGE\bfseries}}
\makeatother

\setcounter{secnumdepth}{-1}
%for weird reasons this does not bookmark the section start, but the start of text in the section!!!
%\renewcommand\thesection{}
\renewcommand{\sectionmark}[1]{%
\markboth{\large #1}{\rightmark}
}
\renewcommand{\subsectionmark}[1]{%
\markboth{\large #1}{\rightmark}
}
\renewcommand{\chaptermark}[1]{%
\markboth{\large #1}{\rightmark}
}

\addtolength{\parskip}{4pt}
%\addtolength{\headsep}{10pt}
\setlength{\columnseprule}{1pt}
\setlength{\columnsep}{30pt}

%%% HYPERLINKS %%%
\usepackage[a5paper,bookmarks=true,bookmarksopen=true,xetex,colorlinks=true,
linkcolor=black,					% colour of internal links
citecolor=cyan,					% colour of links to bibliography
filecolor=magenta,			% colour of file links
urlcolor=black					% colour of external links
]{hyperref}

%%% MISCELLANEOUS %%%
\hbadness=10000
\vbadness=10000
\hfuzz=6pt
%\listfiles

\newcommand{\itibala}[2]{\addtocounter{totalshlokas}{\value{shlokacount}}\addtocounter{kandashlokas}{\value{shlokacount}}
{\normalsize आदितः श्लोकाः — \devanumber{\value{totalshlokas}}}

॥इति श्रीमदध्यात्मरामायणे उमामहेश्वरसंवादे #1~#2~सर्गः॥\devanumber{\value{sargacount}}॥

\closesub
}
\newcommand{\iti}[2]{\addtocounter{totalshlokas}{\value{shlokacount}}\addtocounter{kandashlokas}{\value{shlokacount}}
{\normalsize आदितः श्लोकाः — \devanumber{\value{totalshlokas}}\hfill #1 आदितः श्लोकाः —\devanumber{\value{kandashlokas}}}

॥इति श्रीमदध्यात्मरामायणे उमामहेश्वरसंवादे #1~#2~सर्गः॥\devanumber{\value{sargacount}}॥

\closesub
}
\newcommand{\itikanda}[1]{
#1

\closesection
}
